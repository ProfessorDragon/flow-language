{"scripts": [{"name": "main", "blocks": [["script_start"], ["var_set", "MAXSIZE", "512"], ["var_set", "MIDDLE", "MAXSIZE//2"], ["var_set", "PADDING", "MIDDLE//2"], ["var_set", "DOTPOSITIONS", "((1, 1), (2, 1), (3, 1), (1, 2), (2, 2), (3, 2), (1, 3), (2, 3), (3, 3))"], ["import", "itertools"], ["var_set", "perms", "list(itertools.permutations(range(9)))"], ["var_set", "curperm", "0"], ["var_set", "bestperms", "[]"], ["var_set", "bestintersects", "0"], ["var_set", "finished", "False"], ["var_set", "args", "None"], ["create_window", "\"Grid Intersections\""], ["canvas_outline_width", "0"], ["create_canvas", "MAXSIZE", "MAXSIZE+PADDING"], ["canvas_font", "\"Courier\"", "24", "\"bold\""], ["canvas_fill", "\"lightgray\""], ["iterate", "DOTPOSITIONS", "pos", [["create_oval", "pos[0]*PADDING-8", "pos[1]*PADDING-8", "16", "16"]]], ["disable_resize"], ["script_after_time", "nextiter", "1"], ["script_on_key_tk", "keypress"], ["show_window"]]}, {"name": "nextiter", "blocks": [["script_start"], ["delete_object", "\"line\""], ["delete_object", "\"text\""], ["if", ["and", ["gt_equal", "curperm", ["length", "perms"]], ["not", "finished"]], [["canvas_add_tag", ["create_text", "MIDDLE", "MAXSIZE", "\"Finished!\"", "\"center\""], "\"text\""], ["canvas_add_tag", ["create_text", "MIDDLE", "MAXSIZE+30", "\"Press space for gallery\"", "\"center\""], "\"text\""], ["var_set", "finished", "True"], ["var_set", "curperm", "0"], ["return_value", "\"\""]]], ["else_if", ["and", ["gt_equal", "curperm", ["length", "bestperms"]], "finished"], [["var_set", "curperm", "0"]]], ["forever", [["if", "finished", [["canvas_add_tag", ["create_text", "MIDDLE", "MAXSIZE", "f\"{curperm+1}/{len(bestperms)}\"", "\"center\""], "\"text\""], ["canvas_add_tag", ["create_text", "MIDDLE", "MAXSIZE+30", "bestperms[curperm]", "\"center\""], "\"text\""], ["var_set", "cur", "bestperms[curperm]"]]], ["else", [["canvas_add_tag", ["create_text", "MIDDLE", "MAXSIZE", "f\"{curperm} {round(curperm/len(perms)*100, 2)}%\"", "\"center\""], "\"text\""], ["canvas_add_tag", ["create_text", "MIDDLE", "MAXSIZE+30", "perms[curperm]", "\"center\""], "\"text\""], ["var_set", "cur", "perms[curperm]"]]], ["var_set", "ok", "True"], ["enumerate", "cur", "i", "n", [["if", ["equals", "i", ["subtract", ["length", "cur"], "1"]], [["continue_loop"]]], ["var_set", "pos", "DOTPOSITIONS[n]"], ["var_set", "pos2", "DOTPOSITIONS[cur[i+1]]"], ["iterate", "[1, 3, 4, 5, 7]", "n2", [["var_set", "pt", "DOTPOSITIONS[n2]"], ["if", ["or", ["equals", "pos", "pt"], ["equals", "pos2", "pt"]], [["continue_loop"]]], ["if", ["contains", "cur[:i]", "n2"], [["continue_loop"]]], ["var_set", "args", "(pos[0], pos[1], pos2[0], pos2[1], pt[0], pt[1])"], ["if", ["run_script", "onsegment"], [["var_set", "ok", "False"], ["break_loop"]]]]], ["if", ["not", "ok"], [["break_loop"]]]]], ["if", ["not", "ok"], [["var_increment", "curperm", "1"], ["continue_loop"]]], ["var_set", "segs", "[]"], ["enumerate", "cur", "i", "n", [["if", ["equals", "i", ["subtract", ["length", "cur"], "1"]], [["continue_loop"]]], ["var_set", "pos", "DOTPOSITIONS[n]"], ["var_set", "pos2", "DOTPOSITIONS[cur[i+1]]"], ["array_append", "segs", "[pos[0], pos[1], pos2[0], pos2[1]]"], ["canvas_outline_width", ["nested_if", "finished", "1", "6"]], ["canvas_fill", "\"black\""], ["canvas_add_tag", ["create_arrow", "pos[0]*PADDING", "pos[1]*PADDING", "pos2[0]*PADDING", "pos2[1]*PADDING"], "\"line\""]]], ["var_set", "count", ["subtract", "2", ["length", "cur"]]], ["enumerate", "segs", "i", "seg", [["iterate", "segs[i+1:]", "seg2", [["var_set", "args", "(seg, seg2)"], ["if", ["run_script", "segsintersect"], [["var_increment", "count", "1"]]]]]]], ["var_set", "delay", "1"], ["if", "finished", [["var_set", "delay", "0"]]], ["else_if", ["equals", "count", "bestintersects"], [["array_append", "bestperms", "cur"], ["if", ["gt", "count", "6"], [["var_set", "delay", "0"]]]]], ["else_if", ["gt", "count", "bestintersects"], [["console_output", "\"new best: \"+str(count)"], ["var_set", "bestperms", "[cur]"], ["var_set", "bestintersects", "count"], ["if", ["gt", "count", "6"], [["var_set", "delay", "0"]]]]], ["canvas_add_tag", ["create_text", "MIDDLE", "MAXSIZE+60", "f\"{count} intersections\"", "\"center\""], "\"text\""], ["break_loop"]]], ["var_increment", "curperm", "1"], ["if", ["not", "finished"], [["if", "True", [["script_after_time", "nextiter", "1"]]], ["else_if", ["gt", "delay", "0"], [["script_after_time", "nextiter", "delay"]]]]]]}, {"name": "segsintersect", "blocks": [["script_start"], ["var_set", "seg", "args[0]"], ["var_set", "seg2", "args[1]"], ["var_set", "args", "(seg[0], seg[1], seg[2], seg[3], seg2[0], seg2[1])"], ["var_set", "o1", ["run_script", "ptorient"]], ["var_set", "args", "(seg[0], seg[1], seg[2], seg[3], seg2[2], seg2[3])"], ["var_set", "o2", ["run_script", "ptorient"]], ["var_set", "args", "(seg2[0], seg2[1], seg2[2], seg2[3], seg[0], seg[1])"], ["var_set", "o3", ["run_script", "ptorient"]], ["var_set", "args", "(seg2[0], seg2[1], seg2[2], seg2[3], seg[2], seg[3])"], ["var_set", "o4", ["run_script", "ptorient"]], ["if", ["and", ["not_equal", "o1", "o2"], ["not_equal", "o3", "o4"]], [["return_value", "True"]]], ["var_set", "args", "(seg[0], seg[1], seg[2], seg[3], seg2[0], seg2[1])"], ["if", ["and", ["equals", "o1", "0"], ["run_script", "onsegment"]], [["return_value", "True"]]], ["var_set", "args", "(seg[0], seg[1], seg[2], seg[3], seg2[2], seg2[3])"], ["if", ["and", ["equals", "o2", "0"], ["run_script", "onsegment"]], [["return_value", "True"]]], ["var_set", "args", "(seg2[0], seg2[1], seg2[2], seg2[3], seg[0], seg[1])"], ["if", ["and", ["equals", "o3", "0"], ["run_script", "onsegment"]], [["return_value", "True"]]], ["var_set", "args", "(seg2[0], seg2[1], seg2[2], seg2[3], seg[2], seg[3])"], ["if", ["and", ["equals", "o4", "0"], ["run_script", "onsegment"]], [["return_value", "True"]]], ["return_value", "False"]]}, {"name": "ptorient", "blocks": [["script_start"], ["var_set", "val", ["subtract", ["multiply", ["subtract", "args[5]", "args[1]"], ["subtract", "args[2]", "args[4]"]], ["multiply", ["subtract", "args[4]", "args[0]"], ["subtract", "args[3]", "args[5]"]]]], ["if", ["gt", "val", "0"], [["return_value", "1"]]], ["if", ["lt", "val", "0"], [["return_value", "2"]]], ["return_value", "0"]]}, {"name": "onsegment", "blocks": [["script_start"], ["return_value", ["equals", ["add", ["distance_between_points", "args[0]", "args[1]", "args[4]", "args[5]"], ["distance_between_points", "args[2]", "args[3]", "args[4]", "args[5]"]], ["distance_between_points", "args[0]", "args[1]", "args[2]", "args[3]"]]]]}, {"name": "keypress", "blocks": [["script_start"], ["if", ["equals", ["event_key_tk"], "\"Escape\""], [["destroy_window"]]], ["else_if", ["equals", ["event_key_tk"], "\"space\""], [["run_script", "nextiter"]]], ["else_if", ["equals", ["event_key_tk"], "\"Return\""], [["console_output", "\"Best intersections: \"+str(bestintersects)"], ["iterate", "bestperms", "perm", [["console_output", ["join_array", "[str(n) for n in perm]", "\" \""]]]]]]]}], "modules": [], "functionalities": {"console": true, "autoinstall": false, "windows": true, "dialogs": true, "modernwindows": true, "random": false, "time": false, "json": false, "keyboard": false, "automation": false, "playsound": false, "tts": false, "translate": false, "gd": false}}