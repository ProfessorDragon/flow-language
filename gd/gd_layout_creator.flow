{"scripts": [{"name": "main", "blocks": [["script_start"], ["var_set", "debug", "False"], ["var_set", "yoffsets", "{39: -9, 35: -13, 140: -13, 1332: -12.5, 67: -12, 1743: -30, 1744: -30}"], ["var_set", "portalids", "[12, 13, 47, 111, 660, 745, 1331]"], ["var_set", "clickobjectids", "[35, 140, 1332, 67, 36, 141, 1333, 84, 1022, 1330, 1704, 1751, *portalids]"], ["var_set", "modebounds", "[[0, True, False], [1, True, True], [2, False, False], [1, True, True], [1, False, True], [0, True, False], [1, False, False]]"], ["comment", "modebounds[0] -> 0 = no bounds, 1 = ship bounds, 2 = ball bounds"], ["comment", "modebounds[1] -> whether to insert a segment separator"], ["comment", "modebounds[2] -> whether you are able to move freely in the mode (like flying)"], ["var_set", "segments", "60"], ["var_set", "repetition", "4"], ["var_set", "levels", ""], ["var_set", "args", ""], ["var_set", "mode", ""], ["var_set", "bounds", ""], ["var_set", "modey", ""], ["var_set", "flipped", ""], ["var_set", "doflip", ""], ["var_set", "rightcol", ""], ["var_set", "x", ""], ["var_set", "y", ""], ["var_set", "ef", ""], ["var_set", "nextoy", ""], ["var_set", "lastseg", ""], ["var_set", "lastmodechange", ""], ["var_set", "dct", ""], ["var_set", "layer", ""], ["create_window", "\"GD Layout Creator\""], ["resize_window", "300", "340"], ["create_label", "\"GD Layout Creator\\n\""], ["var_set", "gobutton", ["create_button", "\"Create layout\"", "go"]], ["create_label", "\"\\nLevel name:\""], ["var_set", "levelnameentry", ["create_entry"]], ["add_entry_text", "levelnameentry", "\"Flow Layout\""], ["create_label", "\"\\nTarget duration:\""], ["var_set", "segmententry", ["create_entry"]], ["add_entry_text", "segmententry", "segments"], ["create_label", "\"\\nRepetition spacing:\""], ["var_set", "repetitionentry", ["create_entry"]], ["add_entry_text", "repetitionentry", "repetition"], ["create_label", "\"\""], ["var_set", "umrbutton", ["create_checkbutton", "\"Use most recent segments\""]], ["var_set", "igusebutton", ["create_checkbutton", "\"Debug mode\""]], ["create_label", "\"\""], ["var_set", "progress", ["create_label", "\"Click 'create layout' to start\""]], ["show_window"]]}, {"name": "init", "blocks": [["script_start"], ["var_set", "levels", ["empty_array"]], ["var_set", "args", ["empty_dict"]], ["var_set", "mode", "0"], ["var_set", "bounds", ["array_item", ["array_item", "modebounds", "mode"], "0"]], ["var_set", "modey", "0"], ["var_set", "flipped", "False"], ["var_set", "doflip", "False"], ["var_set", "x", ["random", "4", "7"]], ["var_set", "y", ["random", "1", "2"]], ["var_set", "ef", "False"], ["var_set", "nextoy", "[0, 0, 0]"], ["var_set", "lastseg", ["empty_array"]], ["var_set", "lastmodechange", "0"], ["var_set", "dct", ["empty_dict"]], ["var_set", "layer", "0"]]}, {"name": "go", "blocks": [["script_start"], ["toggle_widget_state", "gobutton", "False"], ["run_script", "init"], ["var_set", "debug", ["checkbutton_value", "igusebutton"]], ["var_set", "f", ["empty_dict"]], ["enumerate", ["add", "[10, 11]", "portalids"], "_", "p", [["array_replace", "f", "p", "[\"v_flip\"]"]]], ["gd_set_fixed_ids", "f"], ["change_widget_text", "progress", "\"Loading database\""], ["force_refresh_window"], ["var_set", "segments", ["multiply", ["from_string", ["entry_value", "segmententry"]], "10"]], ["if", ["equals", "segments", "None"], [["return_value", ""]]], ["var_set", "repetition", ["from_string", ["entry_value", "repetitionentry"]]], ["if", ["equals", "repetition", "None"], [["return_value", ""]]], ["gd_init_database"], ["change_widget_text", "progress", "\"Loading created levels\""], ["force_refresh_window"], ["var_set", "levels", ["gd_load_created_levels"]], ["change_widget_text", "progress", "\"Creating level\""], ["force_refresh_window"], ["gd_open_editor", "level"], ["run_script", "create"], ["change_widget_text", "progress", "\"Saving level\""], ["force_refresh_window"], ["if", ["and", ["gt", ["length", "levels"], "0"], ["equals", ["gd_get_level_property", ["array_item", "levels", "0"], "\"name\""], ["entry_value", "levelnameentry"]]], [["array_pop", "levels", "0"]]], ["var_set", "l", ["gd_create_level", ["entry_value", "levelnameentry"]]], ["var_set", "desc", "\"Generated with Flow | Target length: \""], ["var_increment", "desc", ["entry_value", "segmententry"]], ["var_increment", "desc", "\" | Repetition spacing: \""], ["var_increment", "desc", ["entry_value", "repetitionentry"]], ["if", ["checkbutton_value", "umrbutton"], [["var_increment", "desc", "\" | UMR on\""]]], ["if", ["checkbutton_value", "igusebutton"], [["var_increment", "desc", "\" | Debug on\""]]], ["gd_set_level_property", "l", "\"description\"", "desc"], ["gd_set_level_property", "l", "\"length\"", "3"], ["gd_set_level_property", "l", "\"verified\"", "True"], ["gd_set_level_song", "l", ["random", "0", "20"], "False"], ["array_insert", "levels", "0", "l"], ["gd_save_created_levels", "levels"], ["change_widget_text", "progress", "\"Saving database\""], ["force_refresh_window"], ["gd_close_database"], ["change_widget_text", "progress", "\"Done\""], ["toggle_widget_state", "gobutton", "True"], ["force_refresh_window"], ["execute", "\"from subprocess import call, Popen\""], ["execute", "\"call('taskkill /f /im GeometryDash.exe', shell=True)\""], ["execute", "\"Popen('start steam://rungameid/322170', shell=True)\""]]}, {"name": "create", "blocks": [["script_start"], ["with_file", "\"layout_data.json\"", "\"r\"", "f", [["var_set", "data", ["json_to_dict", ["read_file", "f"]]]]], ["var_set", "nextmode", "-1"], ["var_set", "cont", "False"], ["var_set", "contcount", "0"], ["while", ["lt", "x", "segments"], [["comment", "Choose segment"], ["var_set", "modedata", ["dict_get", "data", ["to_string", "mode"], "\"\""]], ["if", ["and", ["gt", "nextmode", "-1"], ["not", ["array_item", ["array_item", "modebounds", "mode"], "2"]]], [["var_set", "segnum", "0"]]], ["else_if", ["lt", "contcount", ["nested_if", ["checkbutton_value", "umrbutton"], "1", "0"]], [["var_set", "segnum", ["random", ["subtract", ["length", "modedata"], "7"], ["subtract", ["length", "modedata"], "1"]]], ["if", ["lt", "segnum", "0"], [["var_set", "segnum", ["subtract", ["length", "modedata"], "1"]]]]]], ["else", [["var_set", "segnum", ["random", "0", ["subtract", ["length", "modedata"], "1"]]], ["if", ["and", ["contains", "lastseg", "segnum"], ["lt", "contcount", "20"]], [["var_increment", "contcount", "1"], ["console_output", "\"skipped - segment used previously\""], ["continue_loop"]]]]], ["var_set", "seg", ["slice", ["array_item", "modedata", "segnum"], "", ""]], ["var_set", "dct", ["empty_dict"]], ["var_set", "nextx", "0"], ["var_set", "nextmode", "-1"], ["var_set", "nextflip", "False"], ["var_set", "cont", "False"], ["var_set", "doflip", "False"], ["var_set", "objs", ["empty_array"]], ["enumerate", "seg", "_", "v", [["if", ["equals", ["type", "v"], "\"dict\""], [["comment", "Segment data"], ["var_set", "dct", "v"], ["if", ["and", ["not", ["dict_get", "dct", "\"use\"", "True"]], ["not", ["checkbutton_value", "igusebutton"]]], [["var_set", "cont", "True"], ["console_output", "\"skipped - flagged segment\""], ["break_loop"]]], ["var_set", "ty", ["dict_get", "dct", "\"ty\"", "0"]], ["var_set", "by", ["dict_get", "dct", "\"by\"", "0"]], ["var_set", "doflip", ["and", ["dict_get", "dct", "\"canflip\"", "False"], ["random", "0", "1"]]], ["if", ["and", "doflip", ["lt", "lastmodechange", "repetition"]], [["var_set", "cont", "True"], ["console_output", "\"skipped - gravity change after mode portal\""], ["break_loop"]]], ["if", "flipped", [["var_set", "doflip", ["not", "doflip"]]]], ["if", ["equals", "bounds", "0"], [["var_set", "out2", "80"]]], ["else_if", ["equals", "bounds", "1"], [["var_set", "out1", "modey-4"], ["var_set", "out2", "modey+3"]]], ["else_if", ["equals", "bounds", "2"], [["var_set", "out1", "modey-4"], ["var_set", "out2", "modey+3"]]], ["if", "doflip", [["var_swap", "by", "ty"], ["var_set", "ty", "-ty"], ["var_set", "by", "-by"], ["if", ["equals", "bounds", "0"], [["var_set", "out1", "3"]]]]], ["else_if", ["equals", "bounds", "0"], [["var_set", "out1", "1"]]], ["if", ["lt", "out1", "1"], [["if", ["equals", "bounds", "0"], [["var_set", "out1", "1"]]], ["else_if", ["equals", "bounds", "1"], [["var_increment", "out2", "-out1+1"], ["var_increment", "modey", "-out1+1"], ["var_set", "out1", "1"]]], ["else_if", ["and", ["equals", "bounds", "2"], ["lt", "out1", "0"]], [["var_increment", "out2", "-out1"], ["var_increment", "modey", "-out1"], ["var_set", "out1", "1"]]]]], ["if", ["gt", "out2", "80"], [["var_set", "out2", "80"]]], ["console_output", "{\"seg\": dct['name'], \"x\": x, \"y\": y, \"num\": layer, \"mode\": mode, \"modey\": modey, \"flip\": flipped, \"out1\": out1, \"out2\": out2, \"ty\": ty+y, \"by\": by+y, \"cont\": contcount}"], ["if", ["or", ["lt", ["add", "by", "y"], "out1"], ["gt", ["add", "ty", "y"], "out2"]], [["var_set", "cont", "True"], ["console_output", "\"skipped - out of bounds\""], ["break_loop"]]]]], ["else_if", ["equals", ["type", "v"], "\"list\""], [["var_set", "id_", ["array_item", "v", "0"]], ["if", ["contains", "portalids", "id_"], [["if", ["lt", "lastmodechange", "repetition"], [["var_set", "cont", "True"], ["console_output", "\"skipped - mode portal too early\""], ["break_loop"]]]]], ["if", ["gt", ["array_item", "v", "1"], "nextx"], [["var_set", "nextx", ["array_item", "v", "1"]]]]]]]], ["if", "cont", [["var_increment", "contcount", "1"], ["continue_loop"]]], ["var_set", "flipright", ["and", ["not_equal", ["dict_get", "dct", "\"fliprand\"", "None"], "None"], ["random", "0", "1"]]], ["enumerate", "seg", "_", "v", [["if", ["not_equal", ["type", "v"], "\"list\""], [["continue_loop"]]], ["comment", "Add blocks"], ["var_set", "id_", ["array_item", "v", "0"]], ["var_set", "x2", ["add", ["array_item", "v", "1"], "x"]], ["var_set", "y2", ["add", ["array_item", "v", "2"], "y"]], ["var_set", "rot", "0"], ["if", ["gt", ["length", "v"], "3"], [["var_set", "rot", ["array_item", "v", "3"]]]], ["if", ["lt", "id_", "0"], [["comment", "Column"], ["var_set", "args", "{\"x\": x2, \"y\": y2, \"rot\": rot, \"fy\": y}"], ["dict_set", "args", "\"type\"", ["special_operation", "\"abs\"", "id_"]], ["dict_set", "args", "\"oy\"", ["sum", "nextoy"]], ["if", ["and", ["and", "flipright", ["not_equal", ["dict_get", "dct", "\"flipright\"", "None"], "None"]], ["equals", ["array_item", "v", "1"], "nextx"]], [["dict_set", "args", "\"fy2\"", ["multiply", "y+(doflip*-2+1)", ["dict_get", "dct", "\"flipright\"", "2"]]]]], ["run_script", "addcol"]]], ["else", [["var_set", "ids", ["empty_array"]], ["if", ["contains", "portalids", "id_"], [["comment", "Assign mode portal ID"], ["if", ["equals", "id_", ["array_item", "portalids", "mode"]], [["var_set", "nextmode", "mode"]]], ["else", [["while", ["or", ["lt", "nextmode", "0"], ["equals", "nextmode", "mode"]], [["var_set", "nextmode", ["random", "0", "2"]], ["if", ["and", ["dict_get", "dct", "\"unsafe\"", "False"], ["not", ["array_item", ["array_item", "modebounds", "nextmode"], "2"]]], [["var_set", "nextmode", "-1"]]], ["else_if", ["and", ["dict_get", "dct", "\"safe\"", "False"], ["array_item", ["array_item", "modebounds", "nextmode"], "2"]], [["var_set", "nextmode", "-1"]]]]], ["if", "doflip", [["var_set", "modey", ["subtract", ["multiply", "2", "y"], "y2"]]]], ["else", [["var_set", "modey", "y2"]]], ["var_set", "id_", ["array_item", "portalids", "nextmode"]], ["var_set", "lastmodechange", "0"], ["if", ["and", "flipped", ["and", ["not", ["dict_get", "dct", "\"flip\"", "False"]], ["equals", ["random", "0", "2"], "0"]]], [["if", ["or", ["lt", ["length", "v"], "4"], ["equals", ["modulo", ["array_item", "v", "3"], "180"], "0"]], [["array_append", "ids", "10"], ["var_set", "nextflip", "True"]]]]]]]]], ["if", "flipped", [["comment", "Swap reverse gravity portals"], ["if", ["equals", "id_", "10"], [["var_set", "id_", "11"]]], ["else_if", ["equals", "id_", "11"], [["var_set", "id_", "10"]]]]], ["array_append", "ids", "id_"], ["enumerate", "ids", "_", "id_", [["var_set", "o", ["gd_create_object", "id_", "x2", "y2"]], ["if", ["not_equal", ["dict_get", "yoffsets", "id_", "0"], "0"], [["var_set", "o", ["gd_move_object_steps", "o", "0", ["dict_get", "yoffsets", "id_", "0"], "rot"]]]], ["gd_set_object_property", "o", "\"rotation\"", "rot"], ["gd_set_object_property", "o", "\"editor_layer_1\"", "layer"], ["array_append", "objs", "o"]]]]]]], ["var_set", "contcount", "0"], ["console_output", "\"ok\""], ["if", "doflip", [["var_set", "objs", ["gd_flip_object_group", "objs", ["gd_create_object", "0", "x", "y"], "False", "True"]]]], ["enumerate", "objs", "_", "o", [["gd_add_object", "o"]]], ["var_increment", "nextx", "1"], ["if", "debug", [["comment", "Add debug info"], ["if", ["equals", "bounds", "0"], [["var_set", "o", ["gd_create_object", "914", "x", "y+2"]], ["if", "doflip", [["gd_set_object_property", "o", "\"y\"", "y-2"]]]]], ["else", [["var_set", "o", ["gd_create_object", "914", "x", "y"]]]], ["var_set", "name", ["dict_get", "dct", "\"name\"", "\"Unnamed\""]], ["if", ["not", ["dict_get", "dct", "\"use\"", "True"]], [["var_increment", "name", "\"*\""]]], ["gd_set_object_property", "o", "\"text\"", "name"], ["gd_set_object_property", "o", "\"scale\"", "0.5"], ["gd_set_object_property", "o", "\"editor_layer_1\"", "layer"], ["gd_add_object", "o"], ["repeat", "10", "iy", [["if", ["equals", "bounds", "0"], [["var_set", "o", ["gd_create_object", "1756", "x", "y+iy"]], ["if", "flipped", [["gd_set_object_property", "o", "\"y\"", "y+iy-9"]]]]], ["else", [["var_set", "o", ["gd_create_object", "1756", "x", "y+iy-5"]]]], ["gd_set_object_property", "o", "\"editor_layer_1\"", "layer"], ["gd_add_object", "o"]]]]], ["comment", "Add segment separator"], ["run_script", "modecol"], ["comment", "Change values for next segment"], ["array_append", "lastseg", "segnum"], ["if", ["gt", ["length", "lastseg"], "repetition"], [["array_pop", "lastseg", "0"]]], ["var_set", "oy", ["dict_get", "dct", "\"oy\"", "0"]], ["if", "doflip", [["var_set", "oy", "-oy"]]], ["array_append", "nextoy", ["nested_if", ["equals", "bounds", "0"], ["dict_get", "dct", "\"oy\"", "0"], "0"]], ["array_pop", "nextoy", "0"], ["var_set", "ef", ["dict_get", "dct", "\"ef\"", "False"]], ["var_increment", "y", "oy"], ["var_increment", "nextx", ["dict_get", "dct", "\"xx\"", "0"]], ["if", ["not", "nextflip"], [["var_set", "nextflip", ["dict_get", "dct", "\"flip\"", "False"]], ["if", "flipright", [["var_increment", "y", ["multiply", ["dict_get", "dct", "\"fliprand\"", "None"], "(flipped*-2+1)"]], ["var_set", "nextflip", "True"]]]]], ["if", "nextflip", [["var_set", "flipped", ["not", "flipped"]]]], ["if", ["gt", "nextmode", "-1"], [["var_set", "mode", "nextmode"], ["var_set", "bounds", ["array_item", ["array_item", "modebounds", "mode"], "0"]], ["if", ["and", ["and", ["not_equal", "bounds", "1"], ["in_range", "y", "2", "79"]], ["not", ["dict_get", "dct", "\"safe\"", "False"]]], [["var_increment", "y", "flipped*2-1"], ["if", ["and", ["equals", "bounds", "2"], ["in_range", "y", "2", "79"]], [["var_increment", "y", "flipped*2-1"]]]]]]], ["else", [["var_increment", "lastmodechange", "1"]]], ["var_increment", "x", "nextx"], ["var_increment", "layer", "1"]]], ["comment", "Add final column"], ["var_set", "doflip", "flipped"], ["dict_set", "dct", "\"sf\"", "False"], ["run_script", "modecol"]]}, {"name": "modecol", "blocks": [["script_start"], ["var_set", "sf", ["dict_get", "dct", "\"sf\"", "False"]], ["var_set", "args", "{\"x\": x, \"y\": y-1, \"fy\": y}"], ["if", ["equals", "mode", "1"], [["dict_set", "args", "\"y\"", "y-4"], ["var_set", "o", ["gd_create_object", "39", "x", ["add", "y-3", ["divide", ["dict_get", "yoffsets", "39", "0"], "30"]]]], ["gd_set_object_property", "o", "\"editor_layer_1\"", "layer"], ["gd_add_object", "o"], ["var_set", "o", ["gd_copy_object", "o"]], ["gd_set_object_property", "o", "\"y\"", ["subtract", "y+3", ["divide", ["dict_get", "yoffsets", "39", "0"], "30"]]], ["gd_set_object_property", "o", "\"rotation\"", "180"], ["gd_add_object", "o"]]], ["if", ["and", "ef", "sf"], [["dict_set", "args", "\"type\"", "2"]]], ["else_if", ["and", "ef", ["not", "sf"]], [["dict_set", "args", "\"type\"", "4"]]], ["else_if", ["and", ["not", "ef"], "sf"], [["dict_set", "args", "\"type\"", "3"]]], ["run_script", "addcol"], ["dict_set", "args", "\"rot\"", "180"], ["if", ["and", "ef", "sf"], [["dict_set", "args", "\"type\"", "2"]]], ["else_if", ["and", "ef", ["not", "sf"]], [["dict_set", "args", "\"type\"", "3"]]], ["else_if", ["and", ["not", "ef"], "sf"], [["dict_set", "args", "\"type\"", "4"]]], ["if", ["equals", "mode", "1"], [["dict_set", "args", "\"y\"", "y+4"], ["run_script", "addcol"]]], ["else_if", ["equals", "mode", "2"], [["dict_set", "args", "\"y\"", "y+5"], ["run_script", "addcol"]]]]}, {"name": "addcol", "blocks": [["script_start"], ["var_set", "x2", ["dict_get", "args", "\"x\"", "0"]], ["var_set", "y2", ["dict_get", "args", "\"y\"", "0"]], ["var_set", "typ", ["dict_get", "args", "\"type\"", "1"]], ["var_set", "oy", ["sum", "nextoy"]], ["if", ["lt", "oy", "0"], [["var_set", "oy", "0"]]], ["var_set", "rot", ["dict_get", "args", "\"rot\"", "0"]], ["var_set", "topid", "6"], ["var_set", "toprot", "0"], ["var_set", "colid", "7"], ["var_set", "colrot", "0"], ["comment", "Default type is column"], ["if", ["equals", "typ", "2"], [["comment", "Flat"], ["var_set", "topid", "2"], ["var_set", "colid", "5"]]], ["else_if", ["equals", "typ", "3"], [["comment", "Left"], ["var_set", "topid", "3"], ["var_set", "colid", "2"], ["var_set", "colrot", "-90"]]], ["else_if", ["equals", "typ", "4"], [["comment", "Right"], ["var_set", "topid", "3"], ["var_set", "toprot", "90"], ["var_set", "colid", "2"], ["var_set", "colrot", "90"]]], ["var_set", "objs", ["empty_array"]], ["var_set", "o", ["gd_create_object", "topid", "x2", "y2"]], ["gd_set_object_property", "o", "\"rotation\"", "toprot"], ["gd_set_object_property", "o", "\"editor_layer_1\"", "layer"], ["array_append", "objs", "o"], ["repeat", "9+oy", "iy", [["var_set", "o", ["gd_create_object", "colid", "x2", "y2-1-iy"]], ["gd_set_object_property", "o", "\"rotation\"", "colrot"], ["gd_set_object_property", "o", "\"editor_layer_1\"", "layer"], ["array_append", "objs", "o"]]], ["if", "doflip", [["var_set", "objs", ["gd_flip_object_group", "objs", ["gd_create_object", "0", "x2", ["dict_get", "args", "\"fy\"", "y2"]], "False", "True"]]]], ["if", ["not_equal", "rot", "0"], [["var_set", "objs", ["gd_rotate_object_group", "objs", ["array_item", "objs", "0"], "rot"]]]], ["if", ["not_equal", ["dict_get", "args", "\"fy2\"", "None"], "None"], [["var_set", "objs", ["gd_flip_object_group", "objs", ["gd_create_object", "0", "x2", ["dict_get", "args", "\"fy2\"", ""]], "False", "True"]]]], ["enumerate", "objs", "_", "o", [["var_set", "y3", ["gd_get_object_property", "o", "\"y\""]], ["if", ["lt", "y3+.5", "0"], [["break_loop"]]], ["else_if", ["equals", "bounds", "1"], [["if", ["or", ["lt", "y3+.5", "modey-5"], ["gt", "y3-.5", "modey+4"]], [["comment", ["break_loop"]]]]]], ["else_if", ["equals", "bounds", "2"], [["if", ["or", ["lt", "y3+.5", "modey-4"], ["gt", "y3-.5", "modey+3"]], [["comment", ["break_loop"]]]]]], ["gd_add_object", "o"]]]]}], "modules": [], "functionalities": {"console": true, "autoinstall": true, "windows": true, "dialogs": true, "modernwindows": true, "random": true, "time": true, "json": true, "keyboard": false, "playsound": false, "tts": false, "translate": false, "gd": true, "automation": false}}